<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì°¨íŠ¸ í…ŒìŠ¤íŠ¸</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>ì°¨íŠ¸ ë Œë”ë§ í…ŒìŠ¤íŠ¸</h1>
        <button id="loadChart" class="btn btn-primary">ì°¨íŠ¸ ë¡œë“œ</button>
        <div id="chartContainer" class="mt-4">
            <!-- ì°¨íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <script>
        document.getElementById('loadChart').addEventListener('click', function() {
            console.log('ğŸ” ì°¨íŠ¸ ë¡œë”© ì‹œì‘...');
            
            fetch('/financial-api?corp_code=00126380&corp_name=ì‚¼ì„±ì „ì&view_mode=single&year=2022&report_code=11011')
                .then(response => response.json())
                .then(data => {
                    console.log('ğŸ“Š ì‘ë‹µ ë°›ìŒ:', data.success);
                    
                    if (data.success && data.charts) {
                        const container = document.getElementById('chartContainer');
                        let html = '';
                        
                        for (const [chartName, chartHtml] of Object.entries(data.charts)) {
                            console.log(`ğŸ“ˆ ì°¨íŠ¸ ì¶”ê°€: ${chartName}`);
                            html += `
                                <div class="mb-4">
                                    <h3>${chartName}</h3>
                                    ${chartHtml}
                                </div>
                            `;
                        }
                        
                        container.innerHTML = html;
                        console.log('âœ… ì°¨íŠ¸ HTML ì‚½ì… ì™„ë£Œ');
                        
                        // ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
                        const scripts = container.querySelectorAll('script');
                        console.log(`ğŸ“œ ìŠ¤í¬ë¦½íŠ¸ ê°œìˆ˜: ${scripts.length}`);
                        
                        scripts.forEach((script, index) => {
                            try {
                                eval(script.textContent);
                                console.log(`âœ… ìŠ¤í¬ë¦½íŠ¸ ${index + 1} ì‹¤í–‰ ì™„ë£Œ`);
                            } catch (error) {
                                console.error(`âŒ ìŠ¤í¬ë¦½íŠ¸ ${index + 1} ì˜¤ë¥˜:`, error);
                            }
                        });
                    } else {
                        console.error('âŒ ì°¨íŠ¸ ë°ì´í„° ì—†ìŒ');
                    }
                })
                .catch(error => {
                    console.error('âŒ ì˜¤ë¥˜:', error);
                });
        });
    </script>
</body>
</html>